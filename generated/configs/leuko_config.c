/* generated by gen_rule_struct.c - do not edit */
#include "leuko_config.h"
#include "cJSON.h"
#include <string.h>
#include <stdlib.h>

static char *leuko_strdup(const char *s) { if (!s) return NULL; char *r = malloc(strlen(s)+1); if (r) strcpy(r, s); return r; }

void leuko_config_init_defaults(leuko_config_t *out) {
    out->schema_version = leuko_strdup("1.0.0");
    out->general.enabled = true;
    out->general.severity = leuko_strdup("convention");
    leuko_category_layout_init_defaults(&out->categories.layout);
}

int leuko_config_from_json(leuko_config_t *out, const cJSON *json) {
    if (!cJSON_IsObject(json)) return -1;
    cJSON *gen = cJSON_GetObjectItemCaseSensitive(json, "general");
    if (gen && cJSON_IsObject(gen)) { cJSON *e = cJSON_GetObjectItemCaseSensitive(gen, "enabled"); if (e) { if (cJSON_IsBool(e)) out->general.enabled = cJSON_IsTrue(e); else return -1; } cJSON *sev = cJSON_GetObjectItemCaseSensitive(gen, "severity"); if (sev) { if (cJSON_IsString(sev) && sev->valuestring) { free(out->general.severity); out->general.severity = leuko_strdup(sev->valuestring); } else return -1; } }
    cJSON *cats = cJSON_GetObjectItemCaseSensitive(json, "categories");
    if (cats && cJSON_IsObject(cats)) {
        cJSON *cat_layout = cJSON_GetObjectItemCaseSensitive(cats, "layout"); if (cat_layout) { if (leuko_category_layout_from_json(&out->categories.layout, cat_layout) != 0) return -1; }
    }
    return 0;
}

void leuko_config_free(leuko_config_t *out) { if (!out) return; free(out->schema_version); free(out->general.severity); leuko_category_layout_free(&out->categories.layout); }
