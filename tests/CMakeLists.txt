# Tests for configs/compiled_config
add_executable(test_compiled_config configs/test_compiled_config.c)
# Ensure project include headers are visible for tests
target_include_directories(test_compiled_config PRIVATE ${CMAKE_SOURCE_DIR}/include)
# Link against library and yaml if available
if(TARGET libyaml::yaml)
    target_link_libraries(test_compiled_config PRIVATE leuko_lib libyaml::yaml pthread)
elseif(TARGET yaml)
    target_link_libraries(test_compiled_config PRIVATE leuko_lib yaml pthread)
else()
    target_link_libraries(test_compiled_config PRIVATE leuko_lib pthread)
endif()

# walker test
add_executable(test_walker configs/test_walker.c)
target_include_directories(test_walker PRIVATE ${CMAKE_SOURCE_DIR}/include)
if(TARGET libyaml::yaml)
    target_link_libraries(test_walker PRIVATE leuko_lib libyaml::yaml pthread)
elseif(TARGET yaml)
    target_link_libraries(test_walker PRIVATE leuko_lib yaml pthread)
else()
    target_link_libraries(test_walker PRIVATE leuko_lib pthread)
endif()
add_test(NAME test_walker COMMAND test_walker)
if(TARGET libyaml::yaml)
    target_link_libraries(test_compiled_config PRIVATE leuko_lib libyaml::yaml pthread)
elseif(TARGET yaml)
    target_link_libraries(test_compiled_config PRIVATE leuko_lib yaml pthread)
else()
    target_link_libraries(test_compiled_config PRIVATE leuko_lib pthread)
endif()
add_test(NAME test_compiled_config COMMAND test_compiled_config)
